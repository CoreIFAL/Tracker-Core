<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">
    <head>
        <!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>NOME DA PLANILHA</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]-->
        <title>Traker Core</title>
        <link rel="icon" type="image/png" href="../static/images/Traker core logo.png"/>
        <link rel="stylesheet" type="text/css" href="../static/css/main.css">
        <script type="text/javascript" src="../static/js/script.js"></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
        <link href="https://fonts.googleapis.com/css?family=Open+Sans|Roboto" rel="stylesheet">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
        <script type="text/javascript" src="../static/js/searchU.js"></script>
        <script type="text/javascript" src="../static/js/searchM.js"></script>
        <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
        <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
        <link rel="stylesheet" href="//cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css">
        <script>
            $(document).ready(function(){
                // Add smooth scrolling to all links
                $(".mouse").on('click', function(event) {

                    // Make sure this.hash has a value before overriding default behavior
                    if (this.hash !== "") {
                    // Prevent default anchor click behavior
                    event.preventDefault();

                    // Store hash
                    var hash = this.hash;

                    // Using jQuery's animate() method to add smooth page scroll
                    // The optional number (800) specifies the number of milliseconds it takes to scroll to the specified area
                    $('html, body').animate({
                        scrollTop: $(hash).offset().top
                    }, 800, function(){
                
                        // Add hash (#) to URL when done scrolling (default click behavior)
                        window.location.hash = hash;
                    });
                    } // End if
                });
            });
        </script>
    </head>
    <body>
        <div class="carousel slide carousel-fade" data-ride="carousel" data-interval="30000">

            <!-- Wrapper for slides -->
            <div class="carousel-inner" role="listbox">
                <div class="item active">
                </div>
                <div class="item">
                </div>
                <div class="item">
                </div>
                <div class="item">
                </div>
            </div>
        </div>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark" style="z-index: 10;">
                <img src="../static/images/Traker core logo bar.svg" alt="" width="100px" height="auto">
                <a class="navbar-brand inactiveLink" href=""><h1>Tracker Core</h1></a>
                <div class="nav navbar-right">
                    <button class="btn btn-prymary collapsed navbar-right" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                </div>
                <div class="collapse" id="navbarNav">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item active ">
                            <a class="nav-link"><h4>Histórico</h4></a>
                        </li>

                        <li class="nav-item active">
                            <a class="nav-link" href="grafico.html"><h4>Gráfico</h4></a>
                        </li>

                    </ul>
                </div>
            </nav>
            <nav class="navbar navbar-expand-lg navbar-light bg-light" style="z-index: 10;">
                    <div class="container-fluid ">
                  
                      <div class="navbar-header">
                        <a class="navbar-brand inactiveLink" href="#">Acessos</a>
                      </div>
                  
                      <div class="navbar-nav mr-auto">
                        <ul class="nav navbar-nav" style="display: flex; flex-direction: row">
                            <a id="pesB" class="nav-item nav-link" href="#" style="display:" onclick="removeC();">Pesquisar</a>
                            <a id="volB" class="nav-item nav-link" href="#" style="display: none;" onclick="addC();">Voltar</a>
                            <input type="text" id="campoPesquisaU" onkeyup="myFunctionU()" placeholder="Pesquisar por Usuario" style="margin-right: 10px; display: none;">
                            <input type="text" id="campoPesquisaM" onkeyup="myFunctionM()" placeholder="Pesquisar por Maquina" style="margin-right: 5px; display: none;">
                            <script>
                                function removeC() {
                                    if (document.getElementById("searcher").style.display != ""){
                                        var $table = $( '.table' ).isotope( {
                                            itemSelector: '.table-item',
                                        } );
                                        document.getElementById("tabela").style.display = "none";
                                        document.getElementById("pesB").style.display = "none";
                                        document.getElementById("volB").style.display = "";
                                        document.getElementById("searcher").style.display = "";
                                        document.getElementById("campoPesquisaU").style.display = "";
                                        document.getElementById("campoPesquisaM").style.display = "";
                                        $( '.filter-button-group a' ).removeClass( "lab1 lab2 lab3 lab4 lab5 lab6 projetos" );

                                        var filterValue = $( this ).attr( 'data-filter' );
                                        $table.isotope( {
                                            filter: filterValue
                                        } );
                                        setTimeout( function () {

                                        }, 0 );

                                        return false;
                                    }
                                }
                                
                                function addC() {
                                    if (document.getElementById("tabela").style.display != ""){
                                        var $table = $( '.table' ).isotope( {
                                            itemSelector: '.table-item',
                                        } );
                                        document.getElementById("searcher").style.display = "none";
                                        document.getElementById("campoPesquisaU").style.display = "none";
                                        document.getElementById("campoPesquisaM").style.display = "none";
                                        document.getElementById("volB").style.display = "none";
                                        document.getElementById("pesB").style.display = "";
                                        document.getElementById("tabela").style.display = "";
                                        $( this ).addClass( "lab1 lab2 lab3 lab4 lab5 lab6 projetos" );

                                        var filterValue = $( this ).attr( 'data-filter' );
                                        $table.isotope( {
                                            filter: filterValue
                                        } );

                                        return false;
                                    }
                                }
                            </script>
                  
                        </ul>
                  
                      </div>
                  
                      <div class="nav navbar">
                        <li class="nav-item dropdown">
                          <div class="dropdown-content">
                            <!--<li class="nav-item dropdown">
                                    <a class="btn btn-secondary btn-sm dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                      Gerenciar
                                    </a>
                                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                      <a class="dropdown-item" href="#">Ação</a>
                                      <a class="dropdown-item" href="#">Outra ação</a>
                                      <div class="dropdown-divider"></div>
                                      <a class="dropdown-item" href="#">Algo mais aqui</a>
                                    </div>
                                </li>-->
                            <li><a class="btn btn-prymary btn-sm" href="">Atualizar</a></li>
                            <li><div class="dropdown-divider"></div></li>
                            <li><a class="btn btn-prymary btn-sm" onclick="salvaPlanilha();" href="#">Salvar</a></li>
                        </div>
                        </li>
                      </div>
                    </div>
                  </nav>
        <div class="corpo">
            
            <div class="containers">
                <h4 class="center">
                    <!--Imprimindo valores arquivados: 
                    {% for user in users %}
                        {{"|" + user["username"] + "|"}}
                    {% endfor %}-->
                </h4>
                <div>
                    <div>
                        <table style="width:90%; margin-left: 5%;background-color: #343a40; color: #f8f9fa;">
                            <thead >
                                <tr id="tabelaInfo" class="table-item lab1 lab2 lab3 lab4 lab5 lab6 projetos mini" >
                                    <th width="32.4%">Usuario</th>
                                    <th width="19.6%">PC</th>
                                    <th width="21.7%">Status</th>
                                    <th width="11.8%">Data - Hora(GMT-3)</th>
                                </tr>
                            </thead>
                        </table>
                        
                        <div>
                            <div>
                                <table id="searcher" style="width:90%; margin-left: 5%;display: none">
                                    <tbody>
                                    {% for user in lista_users %}
                                    {% set u = user['event']['computername'] %}
                                    {% if 'L01' in u %}
                                        <tr id="tabelaInfo" class="table-item lab1" style="width:90%; margin-left: 5%;background-color: #343a4064; color: #000000">
                                    {% elif 'L02' in u %}
                                        <tr id="tabelaInfo" class="table-item lab2" style="width:90%; margin-left: 5%;background-color: #343a4064; color: #000000">
                                    {% elif 'L03' in u %}
                                        <tr id="tabelaInfo" class="table-item lab3" style="width:90%; margin-left: 5%;background-color: #343a4064; color: #000000">
                                    {% elif 'L04' in u %}
                                        <tr id="tabelaInfo" class="table-item lab4" style="width:90%; margin-left: 5%;background-color: #343a4064; color: #000000">
                                    {% elif 'L05' in u %}
                                        <tr id="tabelaInfo" class="table-item lab5" style="width:90%; margin-left: 5%;background-color: #343a4064; color: #000000">
                                    {% elif 'L06' in u %}
                                        <tr id="tabelaInfo" class="table-item lab6" style="width:90%; margin-left: 5%;background-color: #343a4064; color: #000000">
                                    {% elif 'PROJ' in u %}
                                        <tr id="tabelaInfo" class="table-item projetos" style="width:90%; margin-left: 5%;background-color: #343a4064; color: #000000"> 
                                    {% elif 'MINI' in u %}
                                        <tr id="tabelaInfo" class="table-item mini" style="width:90%; margin-left: 5%;background-color: #343a4064; color: #000000">                                     
                                    {% else %}
                                        <tr style="background-color: #343a4064; color: #f8f9fa">
                                    {% endif %}
                                        <th width="32.4%">{{user['name']}}</th>
                                        <td width="19.6%">{{user['event']['computername']}}</td>
                                        <td width="21.7%">{{user['event']['operation']}}</td>
                                        <td width="11.7%">{{user['event']['date']}} - {{user['event']['time']}}</td>
                                    </tr>
                                    {% endfor %}
                                    </tbody>                                    
                                </table>
                            </div>
                            <div class="table">
                                <table id="tabela" class="col" style="width:90%; margin-left: 5%; display:">
                                    <tbody>
                                    {% for user in lista_users %}
                                    {% set u = user['event']['computername'] %}
                                    {% if 'L01' in u %}
                                        <tr id="tabelaInfo" class="table-item lab1" style="width:90%; margin-left: 5%;background-color: #343a4064; color: #000000">
                                    {% elif 'L02' in u %}
                                        <tr id="tabelaInfo" class="table-item lab2" style="width:90%; margin-left: 5%;background-color: #343a4064; color: #000000">
                                    {% elif 'L03' in u %}
                                        <tr id="tabelaInfo" class="table-item lab3" style="width:90%; margin-left: 5%;background-color: #343a4064; color: #000000">
                                    {% elif 'L04' in u %}
                                        <tr id="tabelaInfo" class="table-item lab4" style="width:90%; margin-left: 5%;background-color: #343a4064; color: #000000">
                                    {% elif 'L05' in u %}
                                        <tr id="tabelaInfo" class="table-item lab5" style="width:90%; margin-left: 5%;background-color: #343a4064; color: #000000">
                                    {% elif 'L06' in u %}
                                        <tr id="tabelaInfo" class="table-item lab6" style="width:90%; margin-left: 5%;background-color: #343a4064; color: #000000">
                                    {% elif 'PROJ' in u %}
                                        <tr id="tabelaInfo" class="table-item projetos" style="width:90%; margin-left: 5%;background-color: #343a4064; color: #000000">
                                    {% elif 'MINI' in u %}
                                        <tr id="tabelaInfo" class="table-item mini" style="width:90%; margin-left: 5%;background-color: #343a4064; color: #000000">                                      
                                    {% else %}
                                        <tr style="background-color: #343a4064; color: #f8f9fa">
                                    {% endif %}
                                        <th width="32.4%">{{user['name']}}</th>
                                        <td width="19.6%">{{user['event']['computername']}}</td>
                                        <td width="21.7%">{{user['event']['operation']}}</td>
                                        <td width="11.7%">{{user['event']['date']}} - {{user['event']['time']}}</td>
                                    </tr>
                                    {% endfor %}
                                    </tbody>                                    
                                </table>
                            </div>
                            
                        </div>
                    </div>
                </div>
                <script>
                    function salvaPlanilha() {
                        var htmlPlanilha = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Acessos</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>' + document.getElementById("tabela").innerHTML + '</table></body></html>';
                    
                        var htmlBase64 = btoa(htmlPlanilha);
                        var link = "data:application/vnd.ms-excel;base64," + htmlBase64;
                    
                        var hyperlink = document.createElement("a");
                        hyperlink.download = "Acessos Tracker Core dia:";
                        hyperlink.href = link;
                        hyperlink.style.display = 'none';
                    
                        document.body.appendChild(hyperlink);
                        hyperlink.click();
                        document.body.removeChild(hyperlink);
                    }
                </script>
                
            </div>
            <div class="filter-button-group containerLateral">
                <div class="containerL" style="position: fixed;">
                        <a class="nav-item nav-link lateralLink" onclick="addC();" data-filter="*" href="">Todos os LABS</a>
                        <a class="nav-item nav-link lateralLink" onclick="addC();" data-filter=".lab1" href="">LAB 1</a>
                        <a class="nav-item nav-link lateralLink" onclick="addC();" data-filter=".lab2" href="">LAB 2</a>
                        <a class="nav-item nav-link lateralLink" onclick="addC();" data-filter=".lab3" href="">LAB 3</a>
                        <a class="nav-item nav-link lateralLink" onclick="addC();" data-filter=".lab4" href="">LAB 4</a>
                        <a class="nav-item nav-link lateralLink" onclick="addC();" data-filter=".lab5" href="">LAB 5</a>
                        <a class="nav-item nav-link lateralLink" onclick="addC();" data-filter=".lab6" href="">LAB 6</a>
                        <a class="nav-item nav-link lateralLink" onclick="addC();" data-filter=".projetos" href="">Projetos</a>
                        <a class="nav-item nav-link lateralLink" onclick="addC();" data-filter=".mini" href="">Mini auditório</a>
                        <div class="scrollup fa fa-angle-double-up" title="Go to top"> ^ </div>
                        <script>
                            // scrolltop
                        $('.scrollup').click(function (){
                        $("html,body").animate({
                        scrollTop: 0
                        }, 1000);
                        return false;
                        });
                        </script>
                </div>
            </div>
        </div>
        <!-- <script src="https://code.jquery.com/jquery-2.2.0.min.js"></script> -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
        <script src="../static/js/ajax.js"></script>
        <script src="../static/js/selector.js"></script>
    </body>
</html>